# Excel基础

### 对于本次课程的内容概括：

本次课程主要针对人群为零基础用户以及有一定接触的初学者。课程的内容设置主要为了实现以下几个目的：
1. 使学习者快速的、全面的了解excel的常用的基础功能及操作方法；
2. 以数据分析类工作的主要框架为主线，穿插在实际操作时常见问题，使学习者理解excel以及数据分析类工作的思考逻辑及方式，完善自身的知识体系；
3. 通过对于常见问题以及技巧经验的分享，使学习者达到快速上手、短期入门的成果；

{{TOC}}

/57a850acbe6e8.jpg



-------------------------------------------------------

## Forward : 关于Excel的123
> Excel在日常工作中已经成为不可或缺的工具，尤其是在数据分分析、处理、展示等方面，已经演变成必备的工具。

**对于这款工具我们需要知道如下几个要点：**

本节视频接下来的时间，我来和大家简单的聊聊关于excel常见的疑问与需要了解的篇外知识：
1. 关于版本
2. 关于excel能做什么
3. 关于数据量
4. 关于功能复杂度与效率的冲突
5. 关于解决问题的决策，是需要有限选择基础功能，其次考虑函数，再次考虑VBA
6. 关于辅助工具与加载项
7. 关于键盘流与鼠标流

> **要点如下：**
1. Excel是一款桌面终端工具，它非常适用于一些小数据量、低复杂度的操作；
2. Excel是有版本区别的，其中各版本都会有不同的差异，版本越高，功能相对于越健全；
3. 使用Excel的时候，不是越复杂越好，应当尽量使用其基础功能，会更加有效率；
4. 关于VBA与宏：适当的使用或录制宏方便批量、重复的进行一些固定的工作，但是一味的追求功能强大会增加复杂度，从而降低效率；
5. 除了复杂的公式和大数据量，复杂的格式也会增加性能的消耗以及内存的占用；
虽然2016版的excel支持100w数据，但是受限于系统和硬件，数据量尽量低于10w，最多尽量别超过50w，否则会出现卡顿，这时应当选择将excel设置成手动计算模式，关闭掉实时计算的模式，同时选择性的关掉自动保存功能，以提高效率；
7. 单元格里的值都会存储为其实际的数据类型（如：数值、字符、日期戳），我们看到的只是其显示格式，显示格式是可以进行各种调整的，调整过程不影响其实际值；
8. 巧妙的利用条件格式，是能够提高数据的可读性的；
9. 适当的掌握一些快捷键能够提·高我们的操作效率；


----------------------------------------------------------
## Chapter 1 :基础准备
> 本节目标：对Excel有一个简单的认识,对基础操作有简单的了解,对基础的概念简单的认知。内容难度为***扫盲级***，有一定基础者可以跳过。

> 知识点：

#### 1.1 **认识Excel表的基础对象：**

| **知识点** | **操作** |
|:--|:--|
| Excel的基础组成部分 | 工作薄、工作表、行列、单元格、值 |
| 引用区间 | 鼠标选择或名称框输入 |
| 函数 | 在编辑栏或单元格中输入“=” |


#### 1.2 **数据类操作：**

| **知识点** | **关键点** | **快捷键** |
|:--|:--|:--|
| 快速选择 | 结合快捷键、名称栏、定位、冻结快速选择定位 | Shift+Ctrl+方向、Ctrl+G |
| 拖拽 | 拖拽插入、拖拽复制插入 | Shift+鼠标拖动、Shift+Ctrl+鼠标拖动 |
| 填充 | 填充功能、拖拽填充 | 鼠标下拖或者双击，完成后出现选择框中可以选择填充类型 |
| 粘贴 | 选择性粘贴可以应用数据的转置、批量运算、数值或格式、公式的复制 |  |
| 筛选 | 选择首行筛选时要保证没有空行，否则最好选择整列；筛选可以选择多种匹配方式以及使用格式作为筛选条件 |  |
| 排序 | 最安全的办法是使用数据->排序->选择排序列及升降序；Tip：字符型特定排序，可采用辅助字段排序 |  |
| 冻结窗口 |  |  |
| 查找替换 | 替换时是可以替换公式中的引用的 |  |
| 单元格换行 |  | Alt+Enter |


#### 1.3 **格式类操作：**

| **知识点** | **关键点** | 
|:--|:--|
| 单元格及区域的格式 | 颜色、文本、位置、缩进 |
| 颜色设置 | 颜色是可以输入颜色值来调整的 |
| 边框及网格线 | 边框的线条和颜色、样式是可以设置的；可以从菜单中的视图->网格线来控制显示 |

#### 1.4 **其他操作：**

| **知识点** | **关键点** | 
|:--|:--|
| 组合 | 行列组合的主要功能是折叠，应用组合可以将展示的篇幅适当的缩减 |
| 隐藏 | 行、列、表均可以隐藏，其中，行列隐藏是可见的，通过选择包含隐藏行列的区域取消；表隐藏通常是可见的，也可通过设置表属性使其不可见 |
| 保护 | 保护的作用是保护表格不被修改，可以通过审阅菜单设置 |
| 储存 | Excel可以存为多种格式，如csv、txt、xml等|




#### 1.5 **Excel的应用场景：**

应用场景很多，大概分为如下几类：

- *表格展示类*

  该类的主要工作是各种表格的制作和展示，偏重于格式的调整与设计，主要的知识点更多的集中在格式、样式以及一些快捷的输入。另一方面还需掌握与业务相关核心的公式以及计算逻辑。

- *记录储存类*

  该类应用主要是明细数据的储存与记录，进而衍生出如字段（或者变量）的计算、转换、生成，表关联以及数据相关的各种操作，核心点是数据的加工处理以及数据表的记录逻辑的设计。

- *统计分析类*

  该类应用主要是对数据进行以业务为主题的统计分析工作，如常规的描述统计，也可进行假设检验、方差分析等专业的统计分析。主要涉及的功能为各种函数、透视表以及数据分析加载项。

- *工具模版类*

  该类应用主要解决效率问题，可以将重复的、固定的操作制作成模版，模版类型不限与通常的表格，还包括各种仪表盘、活动图表。核心点是各种函数的组合、图表、引用以及控件的应用。

#### 1.6 **数据分析工作的基本流程：**

| 流程 | 常用的知识点 |
|:--|:--|
| 数据采集（获取） | 快捷录入、文本读取、数据库连接 |
| 数据清洗、处理 | 数据规范性、数据有效性、生成新变量 |
| 数据描述与分析 | 分组聚合类函数、透视表 |
| 分析结果展示 | 数据图、条件格式的应用 |

## Chapter 2 ：数据的获取与处理

> 本节基于数据分析的基本流程，主要讲解Excel在数据的获取和处理方面的应用。



#### 2.1 数据的获取：

> 数据的获取途径主要分为两类：一是手工录入；二是导入已有的数据。大家经常遇到的是后者，如读取txt文件，读取csv文件，读取数据库，读取已有的Excel工作薄。下面主要对上述两类涉及的知识点进行讲解。

2.1.1 数据的录入

> 录入的核心是快捷、迅速，涉及到的知识点为：
	快速选择定位
	重复内容的输入
	自动填充、批量填充

| 要点 | 操作 | 快捷键 |
|:--|:--|:--|
| 快速定位 | 利用键盘的快捷键 | Shift或Ctrl+方向、Enter、Tab、Ctrl+G |
| 重复内容输入 | 利用数据有效性的下拉菜单或利用批量填充 | Ctrl+Enter |
| 自动填充 | 双击或者拖拽区域右下角浮现“+”型光标；自动填充功能 |  |

2.1.2 数据的读取
> 数据读取（文本）的核心在于分割符的选择以及字段数值类型的调整，其次是中文编码的调整。
		1.分隔符的选择
		2.数值类型的调整
		3.中文编码
文本的格式常用的是csv和txt。

| 要点 | 描述 |
|:--|:--|
| 分隔符的选择 | 常用的分隔符为“，”、制表符（Tab键）、空格、分号；也可以自定义 |
| 数值类型的调整 | 在导入过程中，需要针对字段的内容选择适合的类型，如日期、文本 |
| 中文编码 | window系统中文编吗与其他系统不同，需要在导入时选择对应编码 |

#### 2.2 数据的清洗：

> 数据的清洗取决于你的目的，但通常离不开如下关键点：
- 完整性：缺失值
- 纯净性：冗余数据
- 字段（变量）内部的一致性
- 字段（变量）内容的唯一性
- 行（记录）的唯一性



###### 2.2.1 完整性：缺失值

缺失值通常是指无记录的数据，在实际应用中通常显示为如下形态：
`取决于数据源对于空值的记录方式`

| 字符 | 名称 |
|:--|:--|
| Na或NA | 空值 |
| null | 空值 |
| ''或“” | 空白 |
| NaN | 空值 |
| 0 | 零 |
| "-" | "-" |


> 通常对于缺失值的处理分为删除和补全两种方式，同样取决于目的。但无论是删除还是补全都需要定位到缺失值的位置，在excel中我们通常通过筛选或查找、替换等方式去做处理。当然也可以根据使用的场景采用一些索引函数或者查找函数来达到目的。


###### 2.2.2 纯净性：冗余数据
往往获得的数据中会存在很多非内容的冗余字符串，如空格、制表符（TAB）键、“.“等，这些数据会影响后期的操作（如：匹配、判断等），在使用时应删除该类数据。

| 目的 | 方法 | Excel操作 |
|:--|:--|:--|
| 删除冗余字符 | 在已知的情况下将冗余字符串替换成''（空白） | 使用Ctrl+H或replace函数替换 |
| 去除空格 | 使用替换或者函数去除多余空格| trim函数 |
| 判断某字符是否存在 | 在已知的字符串中，寻找是否包含某个字符串 | 筛选、查找或者find函数：if(iserror(find("a","abc"))= 0,"存在","不存在") |

###### 2.2.3 字段内部一致性
> 对于同一个字段通常要求要保持一致性，一方面是指数值类型是一致的，如同是数值型、日期型（数值类型在后面要讲到）；另一方面是指该字段要记录的内容的定义上是一致的，比如说一个字段记录的是日期，那么这个字段应该每一项都是日期，如果有一项记录的时间，那就是不一致了。

通常我们检查字段一致性，由于场景不同，除了观察没有什么通用的手段。但是从经验的角度可以使用如下方法：

- 观察数据最后一列，是否是因为数据错位多出一列无名称的列，如果是，则说明是由于数据导入时出现错位导致列不一致
- 通常每列的内容应该是相同的定义，如果是字符型的字段其字符长度应该在一定的区间内，所以通过判断字符长度来观察特殊的记录是否存在不一致的情况。（字符长度函数为len()）。
- 可以使用type()函数来判断数值的类型，但是需要注意，该函数将数值型和日期型记为同一种类型。

###### 2.2.4 字段内容的唯一性

> 通常我们一列数据只记录单一内容，当时往往因为不同的应用场景或者数据生产过程中的便利性，导致一列中会含有多个内容，如：*“汽车行业\金融行业"*这种记录方式表示第一行业是汽车，第二行业是金融。但通常多个内容时，会用逗号或者“\”等特殊符号作为分割符。

检查字段内容是否唯一，通常我们使用2.2.3介绍的观察方法就可以完成。至于如何去处理，我们则需要根据场景和目的不同选择相应的方法：

| 场景或目的 | 方法 | Excel操作 |
|:--|:--|:--|
| 全部保留 | 根据分割符的规律（有的时候分割符是不统一的，需要替换成统一的分割符），对该字段进行分割 | 使用菜单中数据->分列功能 |
| 保留第一个 | 除了选择分列功能，还可以使用函数截取第一个分割符之前的内容 | 使用left(a1,find(",",a1)-1) |

`关于上述字符串处理函数后续章节会详细讲解`

###### 2.2.5 行记录的唯一性（去重）
> 最后一个需要检查的内容是重复问题，处理重复问题根据意图不同可以分为：查找、标示重复、删除重复、约束录入重复。

| 目的 | 方法 | Excel操作 |
|:--|:--|:--|
| 查找、标示重复 | 使用条件格式或函数组合找出一列中是否存在重复内容 | 菜单：开始->条件格式->突出显示单元格->重复项；函数IF(COUNTIF(C:C,C2) > 1,"重复","") |
| 删除重复 | 使用删除重复项功能删除单列或多列同时重复的行或单元格 | 菜单：数据->删除重复项（可以根据情况选择是否扩展） |
| 约束录入 | 使用有效性功能，禁止录入重复的内容 | 菜单：数据->数据验证（有效性）->自定义 输入countif(c:c,c2)=1 |



#### 2.3 数据的处理（列与表）：
> 数据的处理主要是对字段、行以及数据表进行不同程度的改造。
- 	针对列包含了拆分、合并、变形；
- 	针对行包含聚合、分组、切片等；
- 	针对于表有数据的旋转、二维表拆分为一维表（行列互转）等。
  
  字段的处理与数据旋转部分在本节详细讲解，而行的处理部分会分散在数据分组、数据统计部分单独详细介绍。

###### 2.3.0.0 基础-数值类型

> 从excel角度，数据分为三大类型：数值、字符、日期三种类型
> 其中要点之一是，要区分数据类型与数据格式两个概念。可以简单的理解为，数据类型是指数据值实际存储的类型，而数据格式是在数据类型之上的数据展现形式。
> 如：日期型数据储存的形式是“42067”，它代表该时间与1900年1月1日的天数。而它的显示格式我们可以根据需要设置成“2015年1月4日”或“2015-03-04”等。

| 数值类型 | 示例 | 描述 |
|:--|:--|:--|
| 数值型 | 2987，3.141592，12% | 在excel中是不区分整型和浮点型的，统一称为数值型，其格式有数字、货币、会计、科学记数、百分比、分数等 |
| 字符型 | “ABC”，“12”，“¥#” | 在excel中字符型数据使用双引号标记，一切可打印的显式字符，其中，空格也为一种字符表示为“ ” |
| 日期型 | 42067，2018-9-8，2017/09/08 | 由于日期型原始值是两个日期之间的天数，所以日期型进行加减运算 |


###### 2.3.0.1 基础-变量类型
> 所谓变量的类型是从统计的角度定义的，变量一词源于数学，在excel中，可以等同于一个数据表的列，如：性别、年龄。
> 变量的类型，总体上可以分为离散的和连续的，而离散变量（定型变量）又分为名义变量和有序变量。连续变量是具备数值意义和计数意义的，是可以用于算数计算的。
| 变量类型 | 示例 | 描述 |
|:--|:--|:--|
| 名义变量 | 姓名、性别、型号 | 用于标示分类和显示属性信息，只能做拼接和拆分操作不能计算，可以是各种数据类型，但不能计算 |
| 有序变量| 级别，大小 | 用于比较顺序，属于离散型变量，不能做算术运算 |
| 定量变量 | 工资额，收入，年龄 | 具备数值意义、计数意义，可以是数值型数据和日期型数据 |

###### 2.3.1 字符型数据的处理
| 操作 | 原理 | 方法 |
|:--|:--|:--|
| 截取 | 根据字符的相对位置索引号，定位字符起始位置，并输入截取长度 |left\right\mid  |
| 合并 | | |
| 替换 | | |
| 查找 | | |
| 计数 | | |
| 分类分组 | | |

###### 2.3.2 数值型数据处理
| 操作 | 原理 | 方法 |
|:--|:--|:--|
| 算术计算 |  |  |
| 合并 | | |
| 求和、平均、计数 | | |
| 最大最小 | | |
| 四舍五入 | | |

###### 2.3.3 日期型数据处理

当前日期、日期差、日期拼接、截取年月日
Today\days\date\year\month\day

| 操作 | 原理 | 方法 |
|:--|:--|:--|
| 当前日期 |  |  |
| 日期差 | | |
| 日期拼接 | | |
| 年月日周截取 | | |

#### 2.4 数据的分组：

> 数据的分组对于离散型变量叫做分组或分类，对于连续性变量又称离散化，两种类型变量的处理方法逻辑上是一致的，均是跟均目标值的特征以及分类条件进行判断，但由于数据的特点不同在操作时，两种变量有一定的区别

对于离散型变量：
| 方法 | 原理 | 操作 |
|:--|:--|:--|
| 判别法 |  |  |
| 匹配法 | | |


对于连续型变量：
| 方法 | 原理 | 操作 |
|:--|:--|:--|
| 判别法 | | |
| 取整法 | | |

#### 2.5 数据的旋转

> 数据的旋转主要有两种，一个是转置，一个是二维表降维

###### 2.5.1 转置

###### 2.5.2 二维表降维

#### 2.6 数据处理综合示例

> 以车辆管理数据为例，从数据的获取到处理，从需求的拆解到思路的选择，详解的逐步的操作讲解。



## Chapter 3 ：简单的数据统计
> 本章主要讲解在日常工作中经常使用到的统计类的功能
> 本节用到的公式常见的就几种，但是由于场景不同需要活用，
> 所以，除第一节讲基础函数第二节讲透视表外，第三节主要是讲一些实例，会设计一些场景引导大家如何思考


## Chapter 4 ：图表展示
## Chapter 5 ：常用技巧
## Chapter 6 ：附录一：关于函数及函数的应用
## Chapter 7 ：附录二：有趣的打印

